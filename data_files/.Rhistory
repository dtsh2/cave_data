dev.off()
graphics.off()
dev.off()
par(mfrow=c(1,1))
acf(tw1E, lag.max = 288*10,plot=T,main="Wyandotte Cave 2011-2012",xlab="Lag (Days)",labels=F,axes=F,
ylab="Autocorrelation")
axis(at=c(0,0.2,0.4,0.6,0.8,1),labels=c(0,0.2,0.4,0.6,0.8,1),side=2)
box()
axis(at=seq(from=0,to=288*10,by=288),labels=seq(from=0,to=10,by=1),side=1)
legend("topright","p-value = 0.05",lty=2,col="blue",bty="n")
dev.off()
tw2E<-as.matrix(w2E)
tw2E<-as.vector(t(tw2E))
pdf(file = "Wyandotte Cave 2012-2013.pdf")
dev.off()
plot(tw2E,type="l",main="Wyandotte Cave 2012-2013",ylab="# saturated pixels",labels=F,axes=F,xlab="weeks")
axis(at=seq(from=0,to=5000,by=2500),labels=c(0,2500,5000),side=2)
box()
axis(at=seq(from=0,to=length(tw2E),by=288*7),labels=seq(from=0,to=18,by=1),side=1)
dev.off()
wtw2E<-morlet(sqrt(tw2E), x1 = seq_along(tw2E), p2 = NULL, dj = 0.25, siglvl = 0.95)
wavelet.plot(wtw2E,crn.lab="Pixel",x.lab="Time")
dev.off()
par(mfrow=c(1,1))
acf(tw2E, lag.max = 288*10,plot=T,main="Wyandotte Cave 2012-2013",xlab="Lag (Days)",labels=F,axes=F,
ylab="Autocorrelation")
axis(at=c(0,0.2,0.4,0.6,0.8,1),labels=c(0,0.2,0.4,0.6,0.8,1),side=2)
box()
axis(at=seq(from=0,to=288*10,by=288),labels=seq(from=0,to=10,by=1),side=1)
legend("topright","p-value = 0.05",lty=2,col="blue",bty="n")
tw3E<-as.matrix(w3E)
tw3E<-as.vector(t(tw3E))
plot(tw3E,type="l",main="Wyandotte Cave 2013-2014",ylab="# saturated pixels",labels=F,axes=F,xlab="weeks")
axis(at=seq(from=0,to=10000,by=5000),labels=c(0,5000,10000),side=2)
box()
axis(at=seq(from=0,to=length(tw3E),by=288*7),labels=seq(from=0,to=16,by=1),side=1)
dev.off()
wtw3E<-morlet(sqrt(tw3E), x1 = seq_along(tw3E), p2 = NULL, dj = 0.25, siglvl = 0.95)
par(mfrow=c(1,1))
acf(tw3E,na.action=na.pass, lag.max = 288*10,plot=T,main="Wyandotte Cave 2013-2014",xlab="Lag (Days)",labels=F,axes=F,
ylab="Autocorrelation")
axis(at=c(0,0.2,0.4,0.6,0.8,1),labels=c(0,0.2,0.4,0.6,0.8,1),side=2)
box()
axis(at=seq(from=0,to=288*10,by=288),labels=seq(from=0,to=10,by=1),side=1)
legend("topright","p-value = 0.05",lty=2,col="blue",bty="n")
tw1H<-as.matrix(w1H)
tw1H<-as.vector(t(tw1H))
plot(tw1H,type="l",main="Wyandotte Cave deeper 2013-2014",ylab="# saturated pixels",labels=F,axes=F,xlab="weeks")
axis(at=seq(from=0,to=1000,by=500),labels=c(0,500,1000),side=2)
box()
axis(at=seq(from=0,to=length(tw1H),by=288*7),labels=seq(from=0,to=16,by=1),side=1)
dev.off()
wtw1H<-morlet(sqrt(tw1H), x1 = seq_along(tw1H), p2 = NULL, dj = 0.25, siglvl = 0.95)
par(mfrow=c(1,1))
acf(tw1H, lag.max = 288*10,plot=T,main="Wyandotte Cave deeper 2013-2014",xlab="Lag (Days)",labels=F,axes=F,
ylab="Autocorrelation")
axis(at=c(0,0.2,0.4,0.6,0.8,1),labels=c(0,0.2,0.4,0.6,0.8,1),side=2)
box()
axis(at=seq(from=0,to=288*10,by=288),labels=seq(from=0,to=10,by=1),side=1)
legend("topright","p-value = 0.05",lty=2,col="blue",bty="n")
dev.off()
id_wy12 <- c(31:43, 59:64)
id_wy13 <-c(69:76)
id_wyH13 <-c(69, 74, 83, 85)
par(mfrow=c(1,1))
dim(t(w1E))
par(mfrow=c(2,2))
par(oma=c(1,2,1,2))
par(mar=c(2,2,1,1))
u95ci<-rowMeans(t(w1E)[,1:5])+rowSds(t(w1E)[,1:5])/sqrt(length((t(w1E)[1,])))
l95ci<-rowMeans(t(w1E)[,1:5])-rowSds(t(w1E)[,1:5])/sqrt(length((t(w1E))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w1E)[,1:5]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",
col="black",ylab="# saturated pixels",main="Wyandotte January (2011-2012)",bty="n")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w1E)[,6:34])+rowSds(t(w1E)[,6:34])/sqrt(length((t(w1E)[1,])))
l95ci<-rowMeans(t(w1E)[,6:34])-rowSds(t(w1E)[,6:34])/sqrt(length((t(w1E))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w1E)[,6:34]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte February (2011-2012)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w1E)[,35:65])+rowSds(t(w1E)[,35:65])/sqrt(length((t(w1E)[1,])))
l95ci<-rowMeans(t(w1E)[,35:65])-rowSds(t(w1E)[,35:65])/sqrt(length((t(w1E))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w1E)[,35:65]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte March (2011-2012)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
dev.off()
dim(t(w2E))
par(mfrow=c(3,2))
par(oma=c(1,4,1,2))
par(mar=c(4,4,1,1))
u95ci<-rowMeans(t(w2E)[,1:10])+rowSds(t(w2E)[,1:10])/sqrt(length((t(w2E)[1,])))
l95ci<-rowMeans(t(w2E)[,1:10])-rowSds(t(w2E)[,1:10])/sqrt(length((t(w2E))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w2E)[,1:10]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",
col="black",ylab="# saturated pixels",main="Wyandotte November (2012-2013)",bty="n")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
lines(rowMeans(t(w2E)[,1:10]))
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w2E)[,11:42])+rowSds(t(w2E)[,11:42])/sqrt(length((t(w2E)[1,])))
l95ci<-rowMeans(t(w2E)[,11:42])-rowSds(t(w2E)[,11:42])/sqrt(length((t(w2E))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w2E)[,11:42]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte December (2012-2013)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
u95ci<-rowMeans(t(w2E)[,43:72])+rowSds(t(w2E)[,43:72])/sqrt(length((t(w2E)[1,])))
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
l95ci<-rowMeans(t(w2E)[,43:72])-rowSds(t(w2E)[,43:72])/sqrt(length((t(w2E))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w2E)[,43:72]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte January (2012-2013)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w2E)[,73:100])+rowSds(t(w2E)[,73:100])/sqrt(length((t(w2E)[1,])))
l95ci<-rowMeans(t(w2E)[,73:100])-rowSds(t(w2E)[,73:100])/sqrt(length((t(w2E))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w2E)[,73:100]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte February (2012-2013)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w2E)[,101:130])+rowSds(t(w2E)[,101:130])/sqrt(length((t(w2E)[1,])))
l95ci<-rowMeans(t(w2E)[,101:130])-rowSds(t(w2E)[,101:130])/sqrt(length((t(w2E))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w2E)[,101:130]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte March (2012-2013)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
dev.off()
dim(t(w3E))
par(mfrow=c(3,2))
par(oma=c(1,4,1,2))
par(mar=c(4,4,1,1))
u95ci<-rowMeans(t(w3E)[,1:2])+rowSds(t(w3E)[,1:2])/sqrt(length((t(w3E)[1,])))
l95ci<-rowMeans(t(w3E)[,1:2])-rowSds(t(w3E)[,1:2])/sqrt(length((t(w3E))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w3E)[,1:2]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",
col="black",ylab="# saturated pixels",main="Wyandotte November (2013-2014)",bty="n")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w3E)[,3:34])+rowSds(t(w3E)[,3:34])/sqrt(length((t(w3E)[1,])))
l95ci<-rowMeans(t(w3E)[,3:34])-rowSds(t(w3E)[,3:34])/sqrt(length((t(w3E))[1,]))
lims<-na.omit(cbind(u95ci,l95ci))
plot(rowMeans(t(w3E)[,3:34],na.rm=T),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte December (2013-2014)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w3E)[,35:62])+rowSds(t(w3E)[,35:62])/sqrt(length((t(w3E)[1,])))
l95ci<-rowMeans(t(w3E)[,35:62])-rowSds(t(w3E)[,35:62])/sqrt(length((t(w3E))[1,]))
lims<-na.omit(cbind(u95ci,l95ci))
plot(rowMeans(t(w3E)[,35:62]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte January (2013-2014)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w3E)[,63:91])+rowSds(t(w3E)[,63:91])/sqrt(length((t(w3E)[1,])))
l95ci<-rowMeans(t(w3E)[,63:91])-rowSds(t(w3E)[,63:91])/sqrt(length((t(w3E))[1,]))
lims<-na.omit(cbind(u95ci,l95ci))
plot(rowMeans(t(w3E)[,63:91],na.rm=T),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte February (2013-2014)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w3E)[,92:113])+rowSds(t(w3E)[,92:113])/sqrt(length((t(w3E)[1,])))
l95ci<-rowMeans(t(w3E)[,92:113])-rowSds(t(w3E)[,92:113])/sqrt(length((t(w3E))[1,]))
lims<-na.omit(cbind(u95ci,l95ci))
plot(rowMeans(t(w3E)[,92:113],na.rm=T),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte March (2013-2014)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
dev.off()
dim(t(w1H))
par(mfrow=c(3,2))
par(oma=c(1,4,1,2))
par(mar=c(4,4,1,1))
u95ci<-rowMeans(t(w1H)[,1:2])+rowSds(t(w1H)[,1:2])/sqrt(length((t(w1H)[1,])))
l95ci<-rowMeans(t(w1H)[,1:2])-rowSds(t(w1H)[,1:2])/sqrt(length((t(w1H))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w1H)[,1:2]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",
col="black",ylab="# saturated pixels",main="Wyandotte deeper November (2013-2014)",bty="n")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w1H)[,3:34])+rowSds(t(w1H)[,3:34])/sqrt(length((t(w1H)[1,])))
l95ci<-rowMeans(t(w1H)[,3:34])-rowSds(t(w1H)[,3:34])/sqrt(length((t(w1H))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w1H)[,3:34]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",
col="black",ylab="# saturated pixels",main="Wyandotte deeper December (2013-2014)",bty="n")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w1H)[,35:66])+rowSds(t(w1H)[,35:66])/sqrt(length((t(w1H)[1,])))
l95ci<-rowMeans(t(w1H)[,35:66])-rowSds(t(w1H)[,35:66])/sqrt(length((t(w1H))[1,]))
lims<-na.omit(cbind(u95ci,l95ci))
plot(rowMeans(t(w1H)[,35:66],na.rm=T),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte deeper January (2013-2014)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w1H)[,67:95])+rowSds(t(w1H)[,67:95])/sqrt(length((t(w1H)[1,])))
l95ci<-rowMeans(t(w1H)[,67:95])-rowSds(t(w1H)[,67:95])/sqrt(length((t(w1H))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(w1H)[,67:95]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte deeper February (2013-2014)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(w1H)[,96:114])+rowSds(t(w1H)[,96:114])/sqrt(length((t(w1H)[1,])))
l95ci<-rowMeans(t(w1H)[,96:114])-rowSds(t(w1H)[,96:114])/sqrt(length((t(w1H))[1,]))
lims<-na.omit(cbind(u95ci,l95ci))
plot(rowMeans(t(w1H)[,96:114],na.rm=T),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Wyandotte deeper March (2013-2014)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
dev.off()
id_gap1 <- c(12,22,47,66)
id_gap2 <-c(35,36)
id_gap3 <-c(36,39:57)
dim(t(gap1))
par(mfrow=c(2,2))
par(oma=c(1,4,1,2))
par(mar=c(4,4,1,1))
u95ci<-rowMeans(t(gap1)[,1:12])+rowSds(t(gap1)[,1:12])/sqrt(length((t(gap1)[1,])))
l95ci<-rowMeans(t(gap1)[,1:12])-rowSds(t(gap1)[,1:12])/sqrt(length((t(gap1))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(gap1)[,1:12]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",
col="black",ylab="# saturated pixels",main="Gap Cave November (2011-2012)",bty="n")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)
u95ci<-rowMeans(t(gap1)[,13:44])+rowSds(t(gap1)[,13:44])/sqrt(length((t(gap1)[1,])))
l95ci<-rowMeans(t(gap1)[,13:44])-rowSds(t(gap1)[,13:44])/sqrt(length((t(gap1))[1,]))
lims<-na.omit(cbind(u95ci,l95ci))
plot(rowMeans(t(gap1)[,13:44],na.rm=T),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Gap Cave December (2011-2012)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(gap1)[,45:76])+rowSds(t(gap1)[,45:76])/sqrt(length((t(gap1)[1,])))
l95ci<-rowMeans(t(gap1)[,45:76])-rowSds(t(gap1)[,45:76])/sqrt(length((t(gap1))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(gap1)[,45:76]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Gap Cave January (2011-2012)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(gap1)[,77:101])+rowSds(t(gap1)[,77:101])/sqrt(length((t(gap1)[1,])))
l95ci<-rowMeans(t(gap1)[,77:101])-rowSds(t(gap1)[,77:101])/sqrt(length((t(gap1))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(gap1)[,77:101]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Gap Cave February (2011-2012)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
dev.off()
dim(t(gap2))
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
dev.off()
dim(t(gap2))
par(mfrow=c(3,2))
par(oma=c(1,4,1,2))
par(mar=c(4,4,1,1))
u95ci<-rowMeans(t(gap2)[,1:27])+rowSds(t(gap2)[,1:27])/sqrt(length((t(gap2)[1,])))
l95ci<-rowMeans(t(gap2)[,1:27])-rowSds(t(gap2)[,1:27])/sqrt(length((t(gap2))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(gap2)[,1:27]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",
col="black",ylab="# saturated pixels",main="Gap Cave December (2012-2013)",bty="n")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(gap2)[,27:58])+rowSds(t(gap2)[,27:58])/sqrt(length((t(gap2)[1,])))
l95ci<-rowMeans(t(gap2)[,27:58])-rowSds(t(gap2)[,27:58])/sqrt(length((t(gap2))[1,]))
lims<-na.omit(cbind(u95ci,l95ci))
plot(rowMeans(t(gap2)[,27:58],na.rm=T),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Gap Cave January (2012-2013)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(gap2)[,59:87])+rowSds(t(gap2)[,59:87])/sqrt(length((t(gap2)[1,])))
l95ci<-rowMeans(t(gap2)[,59:87])-rowSds(t(gap2)[,59:87])/sqrt(length((t(gap2))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(gap2)[,59:87]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Gap Cave February (2012-2013)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(gap2)[,87:118])+rowSds(t(gap2)[,87:118])/sqrt(length((t(gap2)[1,])))
l95ci<-rowMeans(t(gap2)[,87:118])-rowSds(t(gap2)[,87:118])/sqrt(length((t(gap2))[1,]))
lims<-cbind(u95ci,l95ci)
plot(rowMeans(t(gap2)[,87:118]),type="l",xaxt="n",#xlim=c(0,1200),xaxt="n",
ylim=c(0,max(lims)),xlab="hours",bty="n",
col="black",ylab="# saturated pixels",main="Gap Cave March (2012-2013)")
lines(u95ci,col="grey")
lines(l95ci,col="grey")
axis(side=1, at = seq(from =0, to= 288, by = 288/24),
labels = c(0:24), tick = TRUE,
lty=1)#,outer=T)
u95ci<-rowMeans(t(gap2)[,118:145])+rowSds(t(gap2)[,118:145])/sqrt(length((t(gap2)[1,])))
g1<-as.vector(t(gap1))
g2<-as.vector(t(gap2))
g3<-as.vector(t(gap3))
g4<-as.vector(t(gap4))
w1<-as.vector(t(w1E))
w2<-as.vector(t(w2E))
w3<-as.vector(t(w3E))
w1hole<-as.vector(t(w1H))
##
##
lims<-max(length(g1),length(g2),length(g3),length(g4),length(w1),length(w2),length(w3),length(w1hole))
plot(g1,xlim=c(-18*288,(6*30*288)-18*288),type='l',ylab="No. saturated pixels",xlab='time', xaxt='n',main="Gap cave 2011-2012")
axis(side=1, at = seq(from =-18*288, to= 8640*6, by = 8640),
labels = c("Nov","Dec","Jan","Feb","Mar","Apr","May"), tick = TRUE,
lty=2)
dev.off()
plot(g2,xlim=c(-((4+31)*288),(6*30*288)-((4+31)*288)),type='l',ylab="No. saturated pixels",xlab='time', xaxt='n',main="Gap cave 2012-2013")
axis(side=1, at = seq(from =-((4+31)*288), to= 8640*5, by = 8640),
labels = c("Nov","Dec","Jan","Feb","Mar","Apr","May"), tick = TRUE,
lty=2)
dev.off()
library(lubridate)
library(ggplot2)   # use at least 0.9.3 for theme_minimal()
hrs11<-rep(seq(from=1,to=24,by=2),12)
hrs12<-rep(seq(from=0,to=23,by=2),12)
hrs<-c(hrs11,hrs12)
tgp1<-as.data.frame(t(gap1))
tgp1$rs<-rowSums(tgp1)
tgp1$hrs<-sort(hrs)
res.dat.gp1<-aggregate(tgp1$rs, by=list(tgp1$hrs), FUN=sum)[2]
res.dat.gp1$hr<-0:23
dat.p.gp1<-as.data.frame(rep(0:23,times=c(res.dat.gp1$x)))
colnames(dat.p.gp1)<-'x'
ggplot(dat.p.gp1, aes(x = x)) + geom_histogram(breaks = seq(0,24), width = 2, colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Gap Cave 2011-2012 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
ggplot(dat.p.gp1, aes(x = x)) + geom_histogram(breaks = seq(0,24), colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Gap Cave 2011-2012 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
tgp2<-as.data.frame(t(gap2))
tgp2$rs<-rowSums(tgp2)
tgp2$hrs<-sort(hrs)
res.dat.gp2<-aggregate(tgp2$rs, by=list(tgp2$hrs), FUN=sum)[2]
res.dat.gp2$hr<-0:23
dat.p.gp2<-as.data.frame(rep(0:23,times=c(res.dat.gp2$x)))
colnames(dat.p.gp2)<-'x'
ggplot(dat.p.gp2, aes(x = x)) + geom_histogram(breaks = seq(0,24), colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Gap Cave 2012-2013 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
tgp3<-as.data.frame(t(gap3))
tgp3$rs<-rowSums(tgp3)
tgp3$hrs<-sort(hrs)
res.dat.gp3<-aggregate(tgp3$rs, by=list(tgp3$hrs), FUN=sum)[2]
res.dat.gp3$hr<-0:23
dat.p.gp3<-as.data.frame(rep(0:23,times=c(res.dat.gp3$x)))
colnames(dat.p.gp3)<-'x'
tw1E<-as.data.frame(t(w1E))
tw1E$rs<-rowSums(tw1E)
tw1E$hrs<-sort(hrs)
res.dat.w1E<-aggregate(tw1E$rs, by=list(tw1E$hrs), FUN=sum)[2]
res.dat.w1E$hr<-0:23
dat.p.w1E<-as.data.frame(rep(0:23,times=c(res.dat.w1E$x)))
colnames(dat.p.w1E)<-'x'
ggplot(dat.p.w1E, aes(x = x)) + geom_histogram(breaks = seq(0,24), width = 2, colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Wyandotte Cave 2011-2012 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
ggplot(dat.p.w1E, aes(x = x)) + geom_histogram(breaks = seq(0,24), colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Wyandotte Cave 2011-2012 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
res.dat.w1E$hr<-0:24
dat.p.w1E<-as.data.frame(rep(0:24,times=c(res.dat.w1E$x)))
ggplot(dat.p.w1E, aes(x = x)) + geom_histogram(breaks = seq(0,23), colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Wyandotte Cave 2011-2012 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
ggplot(dat.p.w1E, aes(x = x)) + geom_histogram(breaks = seq(0,24), colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Wyandotte Cave 2011-2012 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
dat.p.w1E
head(dat.p.w1E)
summary(dat.p.w1E)
tw1H$rs
tw1H<-as.data.frame(t(w1H))
tw1H$rs<-rowSums(tw1H)
tw1H$hrs<-sort(hrs)
tw1H
res.dat.w1H$hr<-0:23
res.dat.w1H<-aggregate(tw1H$rs, by=list(tw1H$hrs), FUN=sum)[2]
res.dat.w1H$hr<-0:23
tw1H
tai;l(tw1H
tail(tw1H)
tw1H<-as.data.frame(t(w1H))
tw1H$rs<-rowSums(tw1H)
tw1H$hrs<-sort(hrs)
res.dat.w1H<-aggregate(tw1H$rs, by=list(tw1H$hrs), FUN=sum)[2]
res.dat.w1H$hr<-0:23
tw3E<-as.data.frame(t(w3E))
tw3E$rs<-rowSums(tw3E)
tw3E$hrs<-sort(hrs)
res.dat.w3E<-aggregate(tw3E$rs, by=list(tw3E$hrs), FUN=sum)[2]
res.dat.w3E$hr<-0:24
res.dat.w3E$hr<-1:24
dat.p.w3E<-as.data.frame(rep(1:24,times=c(res.dat.w3E$x)))
colnames(dat.p.w3E)<-'x'
ggplot(dat.p.w3E, aes(x = x)) + geom_histogram(breaks = seq(0,24), width = 2, colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Wyandotte Cave 2013-2014 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
ggplot(dat.p.w3E, aes(x = x)) + geom_histogram(breaks = seq(0,24), colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Wyandotte Cave 2013-2014 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
par(mfrow=c(1,1))
rose.diag(dat.p.gp1$x, bin=23, col="blue",
main="Gap 1",prop=6)
rose.diag(dat.p.gp2$x, bin=23, col="blue",
main="Gap 2",prop=6)
rose.diag(dat.p.gp3$x, bin=23, col="blue",
main="Gap 3",prop=6)
rose.diag(dat.p.gp4$x, bin=23, col="blue",
main="Gap 4",prop=6)
rose.diag(dat.p.w1E$x, bin=23, col="blue",
main="Wyandotte 1",prop=6)
rose.diag(dat.p.w1H$x, bin=23, col="blue",
main="Wyandotte 1 Hole",prop=6)
rose.diag(dat.p.w2E$x, bin=23, col="blue",
main="Wyandotte 2",prop=6)
