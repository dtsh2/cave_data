getwd()
rm(list=ls())
library(dplR)
library(xts)
gap1 = read.csv("Gap_2011-2012.csv",na.strings=c("NA"," - "),header=F)
dim(gap1)
gap2 = read.csv("Gap_2012-2013.csv",na.strings=c("NA"," - "),header=F)
dim(gap2)
gap3 = read.csv("Gap_2013-2014.csv",na.strings=c("NA"," - "),header=F)
dim(gap3)
gap4 = read.csv("Gap_2014-2015.csv",na.strings=c("NA"," - "),header=F)
dim(gap4)
w1E = read.csv("WyandotteE_2011-2012.csv",na.strings=c("NA"," - "),header=F)
dim(w1E)
w2E = read.csv("WyandotteE_2012-2013.csv",na.strings=c("NA"," - "),header=F)
dim(w2E)
w3E = read.csv("WyandotteE_2013-2014.csv",na.strings=c("NA"," - "),header=F)
dim(w3E)
w1H = read.csv("WyandotteH_2013-2014.csv",na.strings=c("NA"," - "),header=F)
dim(w1H)
w3E[w3E>10000] <- NA
library(matrixStats) ## this works
g1<-as.vector(t(gap1))
g2<-as.vector(t(gap2))
g3<-as.vector(t(gap3))
g4<-as.vector(t(gap4))
w1<-as.vector(t(w1E))
w2<-as.vector(t(w2E))
w3<-as.vector(t(w3E))
w1hole<-as.vector(t(w1H))
lims<-max(length(g1),length(g2),length(g3),length(g4),length(w1),length(w2),length(w3),length(w1hole))
library(lubridate)
library(ggplot2)   # use at least 0.9.3 for theme_minimal()
hrs11<-rep(seq(from=1,to=24,by=2),12)
hrs12<-rep(seq(from=0,to=23,by=2),12)
hrs<-c(hrs11,hrs12)
tgp1<-as.data.frame(t(gap1))
tgp1$rs<-rowSums(tgp1)
tgp1$hrs<-sort(hrs)
res.dat.gp1<-aggregate(tgp1$rs, by=list(tgp1$hrs), FUN=sum)[2]
res.dat.gp1$hr<-0:23
dat.p.gp1<-as.data.frame(rep(0:23,times=c(res.dat.gp1$x)))
colnames(dat.p.gp1)<-'x'
ggplot(dat.p.gp1, aes(x = x)) + geom_histogram(breaks = seq(0,24), width = 2, colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Gap Cave 2011-2012 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
ggplot(dat.p.gp1, aes(x = x)) + geom_histogram(breaks = seq(0,24),  colour = "grey") + coord_polar(start = 0) + theme_minimal() +
scale_fill_brewer() + ylab("Pixel count") + ggtitle("Gap Cave 2011-2012 \n Activity by hour") +
scale_x_continuous("", limits = c(0, 24), breaks = seq(0, 24), labels = seq(0, 24))
wtgap1<-morlet(sqrt(tgap1), x1 = seq_along(tgap1), p2 = NULL, dj = 0.25, siglvl = 0.95)
tgap1<-as.matrix(gap1,header=F)
tgap1<-as.vector(t(tgap1))
plot(tgap1,type="l",
main="Gap Cave 2011-2012",xlab="weeks",ylab="# saturated pixels",labels=F,axes=F)
wtgap1<-morlet(sqrt(tgap1), x1 = seq_along(tgap1), p2 = NULL, dj = 0.25, siglvl = 0.95)
wavelet.plot(wtgap1,crn.lab="Pixel",x.lab="Time")
wtgap1<-morlet(sqrt(tgap1+1), x1 = seq_along(tgap1), p2 = NULL, dj = 0.25, siglvl = 0.95)
head(tgap1)
head(tgap1+1)
wavelet.plot(wtgap1,crn.lab="Pixel",x.lab="Time")
windows()
wavelet.plot(wtgap1,crn.lab="Pixel",x.lab="Time")
tw1E<-as.matrix(w1E)
tw1E<-as.vector(t(tw1E))
plot(tw1E,type="l",main="Wyandotte Cave 2011-2012",ylab="# saturated pixels",labels=F,axes=F,xlab="weeks")
axis(at=seq(from=0,to=10000,by=5000),labels=c(0,5000,10000),side=2)
box()
axis(at=seq(from=0,to=length(tw1E),by=288*7),labels=seq(from=0,to=9,by=1),side=1)
wtw1E<-morlet(sqrt(tw1E), x1 = seq_along(tw1E), p2 = NULL, dj = 0.25, siglvl = 0.95)
wavelet.plot(wtw1E,crn.lab="Pixel",x.lab="Time")
head(tw1E)
min(tw1E)
test<-tw1E+1
min(tw1E)
min(test)
plot(sqrt(test),type='l')
plot(ln(test),type='l')
plot(log(test),type='l')
mean(log(test))
plot(log(test)-mean(log(test)),type='')
plot((log(test)-mean(log(test))),type='')
test2<-log(test)-mean(log(test))
plot(test2)
wttest2<-morlet(test2, x1 = seq_along(test2), p2 = NULL, dj = 0.25, siglvl = 0.95)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
dev.off()
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
test2<-(log(test)-mean(log(test))/(max(log(test))-min(log(test))))
dev.off()
plot(max(log(test))-min(log(test)))
min(log(test))
test<-tw1E+1
test2<-log(test2)
test2<-log(test)
min(test2)
max(test2)
test3<-(test2-min(test2))/(max(test2)-min(test2))
plot(test3)
z = (test2-mean(test2))/std(test2)
?std
?sd
z = (test2-mean(test2))/sd(test2)
plot(z)
mean(z)
var(z)
std(z)
mean(z)
var(z)
sd(z)
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.25, siglvl = 0.95)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
mean(test2)
median(test2)
sd(test2)
plot(z)
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.5, siglvl = 0.95)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.5, siglvl = 0.99)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
?WaveletComp
install.packages("WaveletComp")
library(WaveletComp)
?morlet
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.9, siglvl = 0.99)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 1, siglvl = 0.99)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.95, siglvl = 0.99)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
x3R <- smooth(z, "3R") # 2 iterations of "3"
plot(x3R)
plot(x3R,type = 'l')
wttest3<-morlet(x3R, x1 = seq_along(x3R), p2 = NULL, dj = 0.95, siglvl = 0.99)
wavelet.plot(wttest3,crn.lab="Pixel",x.lab="Time")
wttest3<-morlet(x3R, x1 = seq_along(x3R), p2 = NULL, dj = 0.1, siglvl = 0.99)
wavelet.plot(wttest3,crn.lab="Pixel",x.lab="Time")
wttest3<-morlet(x3R, x1 = seq_along(x3R), p2 = NULL, dj = 0.5, siglvl = 0.99)
wavelet.plot(wttest3,crn.lab="Pixel",x.lab="Time")
test<-tw1E+1
plot(sqrt(test),type='l')
plot(log(test),type='l')
test2<-log(test)
z = (test2-mean(test2))/sd(test2)
plot(z,type='l')
min(z)
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.95, siglvl = 0.99)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
test<-tw3E+1
tw3E<-as.data.frame(t(w3E))
tw3E$rs<-rowSums(tw3E)
head(tw1E)
test<-tw3E+1
plot(sqrt(test),type='l')
plot(log(test),type='l')
tw1H<-as.data.frame(t(w1H))
tw1H$rs<-rowSums(tw1H)
min(tw1E)
test<-tw1E+1
plot(sqrt(test),type='l')
plot(log(test),type='l')
test2<-log(test)
test2<-sqrt(test)
z = (test2-mean(test2))/sd(test2)
plot(z,type='l')
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.95, siglvl = 0.99)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
test2<-log(test)
z = (test2-mean(test2))/sd(test2)
plot(z,type='l')
plot(z,type='l')
test2<-sqrt(test)
z = (test2-mean(test2))/sd(test2)
plot(z,type='l')
test2<-log(test)
z = (test2-mean(test2))/sd(test2)
plot(z,type='l')
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.95, siglvl = 0.99)
?wavelet.plot
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time",add.spline = T)
tgap1<-as.matrix(gap1,header=F)
tgap1<-as.vector(t(tgap1))
tw1E<-as.matrix(w1E,header=F)
tw1E<-as.vector(t(tw1E))
head(tw1E)
min(tw1E)
test<-tw1E+1
plot(sqrt(test),type='l')
plot(log(test),type='l')
test2<-log(test)
test2<-sqrt(test)
z = (test2-mean(test2))/sd(test2)
plot(z,type='l')
test2<-log(test)
# test2<-sqrt(test)
z = (test2-mean(test2))/sd(test2)
plot(z,type='l')
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.95, siglvl = 0.99)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time",add.spline = T)
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.95, siglvl = 0.999)
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time",add.spline = T)
tw2E<-as.matrix(w2E,header=F)
tw2E<-as.vector(t(tw2E))
head(tw2E)
min(tw2E)
test<-tw2E+1
plot(sqrt(test),type='l')
plot(log(test),type='l')
test2<-log(test)
# test2<-sqrt(test)
z = (test2-mean(test2))/sd(test2)
plot(z,type='l')
wttest2<-morlet(z, x1 = seq_along(z), p2 = NULL, dj = 0.95, siglvl = 0.999)
# wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time")
wavelet.plot(wttest2,crn.lab="Pixel",x.lab="Time",add.spline = T)
